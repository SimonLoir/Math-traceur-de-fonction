<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>SMath Stats</title>
    <link rel="stylesheet" href="stats.css">
    <script src="ext-chart-js.js"></script>
    <script src="../extjs.js"></script>
    <script src="../Smath.js"></script>

</head>

<body>
    <div class="scms-header">
        <div class="scms-header">
            <img class="scms-header-logo" alt="" src="../logo.svg">
            <span class="scms-header-title">SMath Stats</span>
            <div class="scms-header-actions">
                <!--<a class="scms-header-actions-link" href="#p=home">Home</a>-->
            </div>
        </div>
    </div>

    <div class="content">
        <div class="wrapper" style="position:absolute;top:0;left:0;bottom:0;width:calc(50% - 25px);padding:0;margin:0;height:100%;overflow:auto;padding:25px;">
            <button id="new">+</button>
            <label for="use_classes"><input type="checkbox" id="use_classes">Utiliser des classes</label>
            <label for="mediane"><input type="checkbox" id="mediane">Calculer la médiane</label>
            <label for="cq1"><input type="checkbox" id="cq1">Calculer le 1er quartile</label>
            <label for="cq3"><input type="checkbox" id="cq3">Calculer le 3ème quartile</label>
            <label for="moyenne"><input type="checkbox" id="moyenne">Calculer la moyenne</label>
            <table style="width:calc(100% - 25px);" class="e_table">

            </table>
        </div>
        <div class="graph" style="height:100%;width:50%;position:absolute;top:0;right:0;bottom:0;border-left:1px solid darkgray;">

        </div>
    </div>
    <script>
        var s = new SMath();

        $(document).ready(function () {

            var chart = jsChart(".graph", {

                chart: {

                    title: "SMath stats",
                    title_color: "darkgray",
                    type: "circular",
                    width: "fit",
                    height: "fit",
                    theme: "none",
                    hide: []
                },

                datasets: [] // dataset structure : {"label": "Test 1","value": 500}

            });



            $("#new").click(function () {
                
                var x = prompt('xi (caractère)');
                if (x == null || x.trim() == "") {
                    return;
                }
                var e = prompt('Effectif', 1);
                if (e == null || e.trim() == "") {
                    return;
                }
                e = parseFloat(e);
                chart.setDataSets([]);
                if (s.stats.buffer.tab[x.trim()] != undefined) {
                    s.stats.buffer.tab[x.trim()] += e;
                } else {
                    s.stats.buffer.tab[x.trim()] = e;
                }

                var keys = Object.keys(s.stats.buffer.tab);

                keys = keys.sort();

                var table = document.querySelector('.e_table');

                table.innerHTML = "<tr><th>xi</th><th>effectif</th><th>effectif cumulé</th></tr>"
                var eff = 0;
                for (var i = 0; i < keys.length; i++) {
                    var key = keys[i];
                    eff += s.stats.buffer.tab[key];
                    table.innerHTML += "<tr>"
                        + "<td>" + key + "</td>"
                        + "<td>" + s.stats.buffer.tab[key] + "</td>"
                        + "<td>" + eff + "</td>"
                        + "</tr>";
                    chart.newDataSet({"label": key,"value":  s.stats.buffer.tab[key] })
                }
            });

        });
    </script>
</body>

</html>